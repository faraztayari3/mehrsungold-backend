'use strict';const a174_0x193056=a174_0x6458;(function(_0x43a0ab,_0x5a86a1){const _0xe82e57=a174_0x6458,_0x173b32=_0x43a0ab();while(!![]){try{const _0x439d85=-parseInt(_0xe82e57(0x1b6))/0x1*(-parseInt(_0xe82e57(0x19f))/0x2)+parseInt(_0xe82e57(0x1f3))/0x3*(parseInt(_0xe82e57(0x1c2))/0x4)+parseInt(_0xe82e57(0x1cc))/0x5+parseInt(_0xe82e57(0x1b3))/0x6+-parseInt(_0xe82e57(0x1a1))/0x7*(-parseInt(_0xe82e57(0x1c7))/0x8)+-parseInt(_0xe82e57(0x1f1))/0x9+-parseInt(_0xe82e57(0x1a2))/0xa*(parseInt(_0xe82e57(0x1b4))/0xb);if(_0x439d85===_0x5a86a1)break;else _0x173b32['push'](_0x173b32['shift']());}catch(_0x114a60){_0x173b32['push'](_0x173b32['shift']());}}}(a174_0x2de1,0x4eab0));var __decorate=this&&this[a174_0x193056(0x1ec)]||function(_0x2621f3,_0x488540,_0x3bc226,_0x5aeb81){const _0x43c89a=a174_0x193056;var _0x4da94d=arguments[_0x43c89a(0x1db)],_0x245391=_0x4da94d<0x3?_0x488540:_0x5aeb81===null?_0x5aeb81=Object['getOwnPropertyDescriptor'](_0x488540,_0x3bc226):_0x5aeb81,_0x546b3e;if(typeof Reflect===_0x43c89a(0x1ea)&&typeof Reflect['decorate']===_0x43c89a(0x1f5))_0x245391=Reflect[_0x43c89a(0x1af)](_0x2621f3,_0x488540,_0x3bc226,_0x5aeb81);else{for(var _0x13edce=_0x2621f3[_0x43c89a(0x1db)]-0x1;_0x13edce>=0x0;_0x13edce--)if(_0x546b3e=_0x2621f3[_0x13edce])_0x245391=(_0x4da94d<0x3?_0x546b3e(_0x245391):_0x4da94d>0x3?_0x546b3e(_0x488540,_0x3bc226,_0x245391):_0x546b3e(_0x488540,_0x3bc226))||_0x245391;}return _0x4da94d>0x3&&_0x245391&&Object[_0x43c89a(0x1ba)](_0x488540,_0x3bc226,_0x245391),_0x245391;},__metadata=this&&this['__metadata']||function(_0x1feda5,_0x18e0f7){const _0x2b4cf2=a174_0x193056;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x2b4cf2(0x1aa)](_0x1feda5,_0x18e0f7);},__param=this&&this['__param']||function(_0x4c4c3f,_0x30dfff){return function(_0x4460ff,_0x57c49c){_0x30dfff(_0x4460ff,_0x57c49c,_0x4c4c3f);};};function a174_0x2de1(){const _0x258f82=['__decorate','Controller','CreateTicketDto','design:paramtypes','ticketService','1038168fIgmBA','configService','3EXOfmN','../common/message-response','function','@nestjs/platform-express','readTicket','get','ApiCreatedResponse','User\x20not\x20found.','TicketController','Message\x20created\x20successfully.','169430tAYEZd','Get','21WixRTV','2819210GIZztI','./dto/create-message.dto','fs/promises','create',':id/read','writeFile',':id/deactivate','_id','metadata','ApiTags','message','Query','TicketService','decorate','UploadedFile','originalname','GetChatRes','269544nUWmDj','33zLIOtl','createMessage','6IfHnYo','Ticket\x20not\x20found.','./dto/get-chat.dto','MessageResponse','defineProperty','chat','Ticket\x20deactivated\x20successfully.','ticket','image/jpg','@nestjs/config','prototype','application/pdf','1890384HbtENl','ApiBearerAuth','UseInterceptors','../auth/decorator/user-id.decorator','../common/mongo-id.dto','67768xAOrpL','Post','UPLOAD_DIR','image/svgz','GetTicketsRes','1160580xgFJYF','uploadFile','../pipes/type-validator','application/vnd.oasis.opendocument.text','UserId','Patch','@nestjs/swagger','Param','HttpCode','ApiNotFoundResponse','design:returntype','TypeValidator','./dto/get-tickets.dto','MongoIdDto','upload','length','./ticket.service','Body','@nestjs/common','/ticket/','Ticket\x20created\x20successfully.','./dto/create-ticket.dto','image/png','FILES_PATH','Ticket\x20readed\x20successfully.','ParseFilePipe','design:type','getTickets','ApiOkResponse','getChatMessages','object','deactivateTicket'];a174_0x2de1=function(){return _0x258f82;};return a174_0x2de1();}Object[a174_0x193056(0x1ba)](exports,'__esModule',{'value':!![]}),exports['TicketController']=void 0x0;function a174_0x6458(_0xe71071,_0x44ea61){const _0x2de1d6=a174_0x2de1();return a174_0x6458=function(_0x6458c3,_0x1781cd){_0x6458c3=_0x6458c3-0x19e;let _0x5fea7d=_0x2de1d6[_0x6458c3];return _0x5fea7d;},a174_0x6458(_0xe71071,_0x44ea61);}const common_1=require(a174_0x193056(0x1de)),config_1=require(a174_0x193056(0x1bf)),platform_express_1=require(a174_0x193056(0x1f6)),swagger_1=require(a174_0x193056(0x1d2)),promises_1=require(a174_0x193056(0x1a4)),user_id_decorator_1=require(a174_0x193056(0x1c5)),message_response_1=require(a174_0x193056(0x1f4)),mongo_id_dto_1=require(a174_0x193056(0x1c6)),type_validator_1=require(a174_0x193056(0x1ce)),create_message_dto_1=require(a174_0x193056(0x1a3)),create_ticket_dto_1=require(a174_0x193056(0x1e1)),get_chat_dto_1=require(a174_0x193056(0x1b8)),get_tickets_dto_1=require(a174_0x193056(0x1d8)),ticket_service_1=require(a174_0x193056(0x1dc));let TicketController=class TicketController{constructor(_0x3e2d5a,_0xc37f8c){const _0x117a81=a174_0x193056;this[_0x117a81(0x1f0)]=_0x3e2d5a,this['configService']=_0xc37f8c;}async['uploadFile'](_0x6cf981){const _0x51eb89=a174_0x193056,_0x3e3ba2=Date['now']()+'-'+_0x6cf981[_0x51eb89(0x1b1)];return await(0x0,promises_1[_0x51eb89(0x1a7)])(this[_0x51eb89(0x1f2)][_0x51eb89(0x1f8)](_0x51eb89(0x1c9))+_0x51eb89(0x1df)+_0x3e3ba2,_0x6cf981['buffer']),{'fileUrl':this['configService'][_0x51eb89(0x1f8)](_0x51eb89(0x1e3))+'/ticket/'+_0x3e3ba2};}async[a174_0x193056(0x1a5)](_0x41b20d,_0x1c0864){const _0x1592b4=a174_0x193056,_0x4a8263=await this[_0x1592b4(0x1f0)][_0x1592b4(0x1a5)](_0x41b20d,_0x1c0864);return{'message':_0x1592b4(0x1e0),'id':_0x4a8263[_0x1592b4(0x1a9)]};}async[a174_0x193056(0x1b5)](_0xbb6ea9,_0x38f7ee){const _0x552027=a174_0x193056,_0x532aa4=await this[_0x552027(0x1f0)]['createMessage'](_0xbb6ea9,_0x38f7ee);return{'message':_0x552027(0x19e),'id':_0x532aa4[_0x552027(0x1a9)]};}[a174_0x193056(0x1e9)](_0x2cb441,_0xfde807){const _0x2201f2=a174_0x193056;return this[_0x2201f2(0x1f0)][_0x2201f2(0x1e9)](_0x2cb441,_0xfde807);}['getTickets'](_0x5bb55d,_0x3634c5){const _0x528b25=a174_0x193056;return this[_0x528b25(0x1f0)]['getTickets'](_0x5bb55d,_0x3634c5);}async['deactivateTicket'](_0xf361e3,_0x46ca45){const _0x2ef9fe=a174_0x193056;return await this[_0x2ef9fe(0x1f0)][_0x2ef9fe(0x1eb)](_0xf361e3['id'],_0x46ca45),{'message':_0x2ef9fe(0x1bc)};}async['readTicket'](_0x79d078,_0x5172a0){const _0x2481a6=a174_0x193056;return await this['ticketService'][_0x2481a6(0x1f7)](_0x79d078['id'],_0x5172a0),{'message':_0x2481a6(0x1e4)};}};exports[a174_0x193056(0x1fb)]=TicketController,__decorate([(0x0,common_1['Post'])(a174_0x193056(0x1da)),(0x0,swagger_1['ApiBearerAuth'])(),(0x0,common_1[a174_0x193056(0x1c4)])((0x0,platform_express_1['FileInterceptor'])('file')),__param(0x0,(0x0,common_1[a174_0x193056(0x1b0)])(new common_1[(a174_0x193056(0x1e5))]({'validators':[new common_1['MaxFileSizeValidator']({'maxSize':0x5*0x400*0x400}),new type_validator_1[(a174_0x193056(0x1d7))]({'fileTypes':['image/jpeg',a174_0x193056(0x1e2),'image/svg',a174_0x193056(0x1ca),a174_0x193056(0x1be),a174_0x193056(0x1c1),a174_0x193056(0x1cf)]})]}))),__metadata(a174_0x193056(0x1e6),Function),__metadata(a174_0x193056(0x1ef),[Object]),__metadata('design:returntype',Promise)],TicketController[a174_0x193056(0x1c0)],a174_0x193056(0x1cd),null),__decorate([(0x0,common_1[a174_0x193056(0x1c8)])(),(0x0,swagger_1['ApiCreatedResponse'])({'description':a174_0x193056(0x1e0),'type':message_response_1[a174_0x193056(0x1b9)]}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1fa)}),(0x0,swagger_1[a174_0x193056(0x1c3)])(),__param(0x0,(0x0,common_1[a174_0x193056(0x1dd)])()),__param(0x1,(0x0,user_id_decorator_1[a174_0x193056(0x1d0)])()),__metadata(a174_0x193056(0x1e6),Function),__metadata(a174_0x193056(0x1ef),[create_ticket_dto_1[a174_0x193056(0x1ee)],String]),__metadata('design:returntype',Promise)],TicketController['prototype'],a174_0x193056(0x1a5),null),__decorate([(0x0,common_1[a174_0x193056(0x1c8)])(a174_0x193056(0x1ac)),(0x0,swagger_1[a174_0x193056(0x1f9)])({'description':'Message\x20created\x20successfully.','type':message_response_1[a174_0x193056(0x1b9)]}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1fa)}),(0x0,swagger_1['ApiBearerAuth'])(),__param(0x0,(0x0,common_1['Body'])()),__param(0x1,(0x0,user_id_decorator_1[a174_0x193056(0x1d0)])()),__metadata(a174_0x193056(0x1e6),Function),__metadata('design:paramtypes',[create_message_dto_1['CreateChatMessageDto'],String]),__metadata(a174_0x193056(0x1d6),Promise)],TicketController[a174_0x193056(0x1c0)],'createMessage',null),__decorate([(0x0,common_1[a174_0x193056(0x1a0)])(a174_0x193056(0x1bb)),(0x0,swagger_1['ApiOkResponse'])({'type':get_chat_dto_1[a174_0x193056(0x1b2)]}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1b7)}),(0x0,swagger_1[a174_0x193056(0x1c3)])(),__param(0x0,(0x0,common_1[a174_0x193056(0x1ad)])()),__param(0x1,(0x0,user_id_decorator_1['UserId'])()),__metadata(a174_0x193056(0x1e6),Function),__metadata(a174_0x193056(0x1ef),[get_chat_dto_1['GetChatDto'],String]),__metadata(a174_0x193056(0x1d6),Promise)],TicketController['prototype'],'getChatMessages',null),__decorate([(0x0,common_1[a174_0x193056(0x1a0)])(),(0x0,swagger_1[a174_0x193056(0x1e8)])({'type':get_tickets_dto_1[a174_0x193056(0x1cb)]}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1b7)}),(0x0,swagger_1[a174_0x193056(0x1c3)])(),__param(0x0,(0x0,common_1[a174_0x193056(0x1ad)])()),__param(0x1,(0x0,user_id_decorator_1['UserId'])()),__metadata(a174_0x193056(0x1e6),Function),__metadata(a174_0x193056(0x1ef),[get_tickets_dto_1['GetTicketsDto'],String]),__metadata(a174_0x193056(0x1d6),Promise)],TicketController[a174_0x193056(0x1c0)],a174_0x193056(0x1e7),null),__decorate([(0x0,common_1[a174_0x193056(0x1d1)])(a174_0x193056(0x1a8)),(0x0,common_1[a174_0x193056(0x1d4)])(0xc8),(0x0,swagger_1['ApiOkResponse'])({'type':message_response_1[a174_0x193056(0x1b9)],'description':a174_0x193056(0x1bc)}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1b7)}),(0x0,swagger_1['ApiBearerAuth'])(),__param(0x0,(0x0,common_1[a174_0x193056(0x1d3)])()),__param(0x1,(0x0,user_id_decorator_1['UserId'])()),__metadata('design:type',Function),__metadata(a174_0x193056(0x1ef),[mongo_id_dto_1[a174_0x193056(0x1d9)],String]),__metadata('design:returntype',Promise)],TicketController[a174_0x193056(0x1c0)],'deactivateTicket',null),__decorate([(0x0,common_1[a174_0x193056(0x1d1)])(a174_0x193056(0x1a6)),(0x0,common_1[a174_0x193056(0x1d4)])(0xc8),(0x0,swagger_1[a174_0x193056(0x1e8)])({'type':message_response_1[a174_0x193056(0x1b9)],'description':a174_0x193056(0x1e4)}),(0x0,swagger_1[a174_0x193056(0x1d5)])({'description':a174_0x193056(0x1b7)}),(0x0,swagger_1[a174_0x193056(0x1c3)])(),__param(0x0,(0x0,common_1[a174_0x193056(0x1d3)])()),__param(0x1,(0x0,user_id_decorator_1[a174_0x193056(0x1d0)])()),__metadata(a174_0x193056(0x1e6),Function),__metadata('design:paramtypes',[mongo_id_dto_1[a174_0x193056(0x1d9)],String]),__metadata(a174_0x193056(0x1d6),Promise)],TicketController[a174_0x193056(0x1c0)],a174_0x193056(0x1f7),null),exports['TicketController']=TicketController=__decorate([(0x0,swagger_1[a174_0x193056(0x1ab)])(a174_0x193056(0x1bd)),(0x0,common_1[a174_0x193056(0x1ed)])('ticket'),__metadata(a174_0x193056(0x1ef),[ticket_service_1[a174_0x193056(0x1ae)],config_1['ConfigService']])],TicketController);